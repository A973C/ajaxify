(function($){var All=function(){this.a=function($this,t,fn,obj){$this.each(function(i){t=t.split("*").join("$(this)");t+=";";eval(t)})}};$.fn.all=function(e,t,n){var r=$(this);$.fn.all.o=$.fn.all.o?$.fn.all.o:new All;$.fn.all.o.a(r,e,t,n);return r}})(jQuery);(function(e){var t=function(t){var n=window.console,r,i,s=e.extend({verbosity:0},t);r=s["verbosity"];this.a=function(e,t){if(t>=0)i=t;r>i&&n&&n.log(e)}};e.log=function(n,r,i){e.log.o=e.log.o?e.log.o:new t(i);e.log.o.a(n,r)}})(jQuery);(function(e){var t=function(){var t,n,r=[],i;var s=function(e){for(var n=0;n<r.length;n++)if(r[n][0]==e){t=r[n][1];return}t=false};var o=function(n,i,o){if(n.indexOf("#")+1)n=n.split("#")[0];s(n);if(!t){var a=e.get(n,function(s){if(!s||a.getResponseHeader("Content-Type").indexOf("text/html")==-1){if(!o)location=n}t=String(s).replace(/<\!DOCTYPE[^>]*>/i,"").replace(/<(html|head|body|title|meta)([\s\>])/gi,'<div class="document-$1"$2').replace(/<\/(html|head|body|title|meta)\>/gi,"</div>");t=e.trim(t);t=e(e.parseHTML?e.parseHTML(t,document,true):t);r.push([n,t]);u(i)});return}u(i);return};var u=function(n){var r=String(t.html()).replace(/<(script|link)([\s\>])/gi,'<div class="document-$1"$2').replace(/<\/(script|link)\>/gi,"</div>");r=e.trim(r);i=e(e.parseHTML?e.parseHTML(r):r);n&&n()};this.a=function(e,n,r){if(!n)return i;if(n.indexOf("/")!=-1){o(n,r);return}if(n=="+"){o(r,null,true);return}if(n.charAt(0)=="#"){t.find(n).html(r);n="-"}if(n=="-"){var s=function(e){e.html(t.find("#"+e.attr("id")).html())};e.all("fn(*)",s);var u=function(e){i.find("#"+e.attr("id")).remove()};e.all("fn(*)",u);return e}return i.find(".document-"+n)}};e.fn.getPage=function(n,r){var i=e(this);e.fn.getPage.o=e.fn.getPage.o?e.fn.getPage.o:new t;return e.fn.getPage.o.a(i,n,r)}})(jQuery);(function(e){var t=function(t){var n=function(t,n){if(n=="href"){e("head").append('<link rel="stylesheet" type="text/css" '+n+'="'+t+'" />')}else{e("head").append('<script type="text/javascript" '+n+'="'+t+'" />')}e.log(n+" + : "+t)},r=function(t,n){if(n=="href")e("link["+n+"*='"+t+"']").remove();else e("script["+n+"*='"+t+"']").remove();e.log(n+" - : "+t)},i=function(e,t){if(!e)return false;for(var n=0;n<t.length;n++){if(t[n][0]==e){t[n][1]=1;return true}}return false};this.a=function(t,s,o,u){switch(s){case"f":return i(t,u);case"i":return n(t,o);case"r":return r(t,o);default:e.log("Bad operator in Script")}}};e.addScript=function(n,r,i,s){e.addScript.o=e.addScript.o?e.addScript.o:new t;if(n)return e.addScript.o.a(n,r,i,s)}})(jQuery);(function(e){var t=function(t){var n=[],r,i=0,s=e.extend({deltas:true},t);this.a=function(t,r){e.log("Entering Scripts a()");if(!s["deltas"]){t.each(function(){e.addScript(e(this)[0],"i",r)});return}$scriptsN=[];t.each(function(){$scriptsN.push([e(this).attr(r),0]);if(!i)n.push([e(this).attr(r),0])});i++;for(var o=0;o<n.length;o++){n[o][1]=2;if(e.addScript(n[o][0],"f",r,$scriptsN))n[o][1]=1}for(var o=0;o<n.length;o++){if(n[o][1]==2){if(n[o][0])e.addScript(n[o][0],"r",r);n.splice(o,1)}}for(var o=0;o<$scriptsN.length;o++){if($scriptsN[o][1]==0)e.addScript($scriptsN[o][0],"i",r)}n=$scriptsN.slice()};e.addScript(null,null,null,s)};e.fn.addScripts=function(n,r){$this=e(this);if(n=="href"){e.fn.addScripts.h=$this.length?e.fn.addScripts.h:new t(r);if($this.length)e.fn.addScripts.h.a($this,n)}else{e.fn.addScripts.s=$this.length?e.fn.addScripts.s:new t(r);if($this.length)e.fn.addScripts.s.a($this,n)}return $this}})(jQuery);(function(e){var t=function(t){var n,r,i={},s={},o=0,u=e.extend({deltas:true},t),a=function(){e.log("Entering det");var t=e().getPage("link"),n=e().getPage("script");i.c=t.filter(function(){return e(this).attr("rel").indexOf("stylesheet")!=-1});i.s=n.filter(function(){return e(this).attr("src")});i.t=n.filter(function(){return!e(this).attr("src")})},f=function(e){var t=u["inline-hints"];if(!t)return false;t=t.split(", ");for(var n=0;n<t.length;n++)if(e.indexOf(t[n])+1)return true;return false},l=function(){e.log("Entering addtxts");i.t.each(function(){var t=e(this).html();if(t.indexOf(").ajaxify(")==-1&&(u["inline"]||f(t))){e.log("inline script : "+t);try{e.globalEval(t)}catch(n){alert(n)}}return true})},c=function(){e.log("Entering scripts.add()");i.c.addScripts("href");i.s.addScripts("src");l()};this.a=function(){a();if(o++)c();else{i.c.addScripts("href");i.s.addScripts("src")}s.t=null};n=u["deltas"];e().addScripts("href",u);e().addScripts("src",u)};e.scripts=function(n){e.scripts.o=e.scripts.o?e.scripts.o:new t(n);e.scripts.o.a()}})(jQuery);(function(e){var t=function(t,n){var r=e.extend({selector:"a:not(.no-ajaxy)",requestKey:"pronto",requestDelay:0,verbosity:0,deltas:true,inline:true,cb:null,on:true},n),i=function(){e.scripts(r);if(r["cb"])r["cb"]()},s=function(){e.log("Statechange: ");var t=location.href;e.log(t);i()};e(function(){var n=window.history&&window.history.pushState&&window.history.replaceState;e.log("Entering ajaxify...",1,r);if(!n){e.log("HTML5 History API not supported properly - exiting");return}if(!r["on"]){e.log("Plugin set off manually - exiting");return}t.pronto(r);e(window).on("pronto.render",s);e().getPage(location.href,i)})};e.fn.ajaxify=function(n){$this=e(this);new t($this,n);return $this}})(jQuery);if(jQuery)(function($){function _init(e){$.extend(options,e||{});options.$body=$("body");options.$container=$(options.container);currentURL=window.location.href;_saveState();$window.on("popstate",_onPop);options.$body.on("mouseover.pronto",options.selector,_prefetch);options.$body.on("click.pronto",options.selector,_click);ajaxify_forms()}function _prefetch(e){var t=e.currentTarget;if(window.location.protocol!==t.protocol||window.location.host!==t.host)return;$().getPage("+",t.href)}function ajaxify_forms(s){if(!options.forms)return;$("form").submit(function(){$theForm=$(this);$.ajax({type:$theForm.attr("method"),url:$theForm.attr("action"),data:$theForm.serialize(),success:function(data){$.log("Ajaxify forms - method succeeded : "+$theForm.attr("method")+" : action : "+$theForm.attr("action"));if($theForm.attr("data-script").length){try{eval($theForm.attr("data-script")+";")}catch(e){alert(e)}}if($theForm.attr("data-src").length){$.addScript($theForm.attr("data-src"),"i","src")}}});return false})}function _click(e){var t=e.currentTarget;if(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||window.location.protocol!==t.protocol||window.location.host!==t.host){return}if(t.hash&&t.href.replace(t.hash,"")===window.location.href.replace(location.hash,"")||t.href===window.location.href+"#"){_saveState();return}e.preventDefault();e.stopPropagation();if(currentURL==t.href){_saveState()}else{_request(t.href)}}function _request(e){$window.trigger("pronto.request");var t=function(){_render(e,0,true)};$().getPage(e,t)}function _onPop(e){var t=e.originalEvent.state;if(t!==null&&t.url!==currentURL){$window.trigger("pronto.request");var n=function(){_render(t.url,t.scroll,false)};$().getPage(t.url,n)}}function _render(e,t,n){if(requestTimer!==null){clearTimeout(requestTimer);requestTimer=null}requestTimer=setTimeout(function(){_doRender(e,t,n)},options.requestDelay)}function _doRender(e,t,n){$window.trigger("pronto.load");_gaCaptureView(e);_saveState();$("title").html($().getPage("title").html());$this.getPage("-");ajaxify_forms();if(e.indexOf("#")+1){$("html, body").animate({scrollTop:$("#"+e.split("#")[1]).offset().top},500)}currentURL=e;if(n){history.pushState(options.scrollTop?{url:currentURL,scroll:0}:{url:currentURL},"state-"+currentURL,currentURL)}else{_saveState()}$window.trigger("pronto.render");if(options.scrollTop)$window.scrollTop(t)}function _saveState(){if(options.scrollTop){history.replaceState({url:currentURL,scroll:$window.scrollTop()},"state-"+currentURL,currentURL)}else{history.replaceState({url:currentURL},"state-"+currentURL,currentURL)}}function _gaCaptureView(e){if(typeof _gaq==="undefined")_gaq=[];_gaq.push(["_trackPageview"],e)}var $this,$window=$(window),currentURL="",requestTimer=null;var options={selector:"a",requestKey:"pronto",requestDelay:0,forms:false,scrollTop:false};$.fn.pronto=function(e){$this=$(this);_init(e);return $this}})(jQuery)
